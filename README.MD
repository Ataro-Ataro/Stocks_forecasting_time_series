# üìä Nairobi Stock Exchange (NSE) Time Series Analysis

The objective of this project was to build a machine learning‚Äìpowered web application that recommends promising stocks on the Nairobi Securities Exchange (NSE). By leveraging real historical data (2021‚Äì2024), the tool helps investors‚Äîespecially in the Kenyan retail sector‚Äîmake data-informed decisions about where to invest.

![image](Images/image_3.jpg)

## Table of Contents

- [Overview](#overview)
- [Business Understanding](#business-understanding)
- [Data Understanding](#data-understanding)
- [Data Preparation](#data-preparation)
- [Modeling](#modeling)
- [Evaluation](#evaluation)
- [Deployment](#deployment)


## üìù Project Overview

This project focuses on analyzing and forecasting stock market trends using time series data from the *Nairobi Stock Exchange (NSE)*. We use historical data from 2021 to identify stock price trends, sector performance, and volatility patterns. We also forecast future prices using advanced modeling techniques.

The goal is to provide valuable insights for investors, analysts, and policymakers using data science.

---

## Business Understanding

The goal of this project is to predict and recommend promising stocks listed on the Nairobi Securities Exchange (NSE) using machine learning. By analyzing historical and current stock data, the system assists investors‚Äîespecially retail investors‚Äîwith data-driven insights to make smarter, more confident investment decisions.
![Image](Images/image_2.jpg)

## üéØ Objectives

- Analyze historical stock price movements
- Compare sector-level performance
- Study daily returns and volatility
- Forecast future stock prices using time series models

---

## *Business Goals*

- Recommend the top 5 performing stocks based on historical and real-time data.

- Provide a user-friendly interface (Streamlit) to interact with filtered data and generate insights.

- Assist investors with risk-aware investment decisions through precise predictions.

---

## üìÅ Dataset Understanding

- *Source:* Scraped from the official Nairobi Stock Exchange website.  [here](https://www.nse.co.ke/dataservices/)
- *Time Period:* 2021 (Daily frequency)  
- *Rows:* 64,688  
- *Key Columns:*  
  - Date  
  - Code (Stock symbol)  
  - Name (Company name)  
  - Day High, Day Low, Day Price  
  - Previous Price, Change, Change %  
  - Volume, Adjusted Price  

---

## üßπ Data Preparation

- Cleaned and formatted numerical columns  
- Converted date strings to datetime format  
- Removed duplicates and handled missing values  
- Created time series per stock for trend analysis and modeling
- Use of pipelines for preprocessing.

---

## üîç Exploratory Data Analysis (EDA)

- Visualized stock price movements over time  
- Analyzed daily returns to identify volatile stocks  
- Grouped and compared performance by sector  
- Highlighted key trends in top stocks like *Safaricom* and *Equity Bank*

---

## üß† Forecasting Models Used

### 1. *ARIMA*  

Statistical model that uses past values and lagged differences to make forecasts. Suitable for linear, stationary data.

### 2. *Prophet*

Model by Facebook for easy, interpretable time series forecasting. Captures trends, seasonality, and holidays.

### 3. *LSTM (Long Short-Term Memory)*  

A deep learning model ideal for time-dependent data. Captures non-linear, complex patterns using memory cells.  
Used to forecast Safaricom stock prices, showing good ability to follow actual trends.

---

## üìà Key Insights

- Safaricom showed consistent long-term growth  
- Banking sector was highly volatile  
- LSTM performed better than traditional models for capturing stock price behavior  
- Sector-level comparison revealed market imbalances and growth¬†opportunities

---

## Evaluation

- **Metrics:** RMSE (Root Mean Squared Error) for prediction accuracy.
- **Validation:** Comparing models using cross-validation and visualizing user-level predictions.
- **Selection:** Choosing the best-performing model based on accuracy and robustness.

## Model Deployment

The trained recommendation model is deployed as an interactive web application using [Streamlit](https://streamlit.io/). Users can input their preferences and receive personalized movie recommendations in real time.

## üìà Next Steps / Future Improvements

Integrate live NSE API or automatic data refresh
Enhance forecasting with improved LSTM input pipelines
Add portfolio builder or backtesting tools
Build a mobile-ready UI or Android wrapper for retail investors

- **Access:** Run the Streamlit app locally with:
  
  ```bash
  streamlit run app/nse.py
  ```

- **Features:** 
  - User-friendly interface for entering ratings or selecting favorite genres.
  - Displays top recommended movies instantly.
  - Visualizations of recommendation results and user history.

  ```bash
  run nse.py
  ```

See the `app/nse.py` file for deployment details.

---

- **Notebook Usage:** All steps are reproducible in `notebooks/EDA.ipynb and Model.ipynb`.

- **Instructions:**
  1. Download the MovieLens dataset and place `ratings.csv` and `movies.csv` in the `data/` folder.
  2. Install dependencies:

      ```bash
      pip install -r requirements.txt
      ```

  3. Launch the notebook:

      ```bash
      jupyter notebook notebooks/EDA.ipynb & model.ipynb
      ```

  4. Follow the notebook steps: Data Understanding ‚Üí Preparation ‚Üí Modeling ‚Üí Evaluation ‚Üí Deployment

---

## Credits

- Daniel Mutiso [Github link](https://github.com/dantegaucho)
- Stephen Kamiru [Github link](https://github.com/Kamiru17)
- Teresia Wanjiku [Github link](https://github.com/tkariuki227)
- Sylvia Mwangi [Github link](https://github.com/Sylvia-W-Mwangi)

- Meggy Donna [Github link](https://github.com/MegAtaro)

## LICENSE
This project is for educational and academic use. Attribution required if reused.
